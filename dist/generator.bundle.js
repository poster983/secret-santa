(()=>{"use strict";const e="function"==typeof btoa,t="function"==typeof Buffer,n=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder?new TextEncoder:void 0),r=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),o=((e=>{let t={};e.forEach(((e,n)=>t[e]=n))})(r),String.fromCharCode.bind(String)),a=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_"))),c=e?e=>btoa(e):t?e=>Buffer.from(e,"binary").toString("base64"):e=>{let t,n,o,a,c="";const l=e.length%3;for(let l=0;l<e.length;){if((n=e.charCodeAt(l++))>255||(o=e.charCodeAt(l++))>255||(a=e.charCodeAt(l++))>255)throw new TypeError("invalid character found");t=n<<16|o<<8|a,c+=r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}return l?c.slice(0,l-3)+"===".substring(l):c},l=t?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let n=0,r=e.length;n<r;n+=4096)t.push(o.apply(null,e.subarray(n,n+4096)));return c(t.join(""))},i=e=>{if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?o(192|t>>>6)+o(128|63&t):o(224|t>>>12&15)+o(128|t>>>6&63)+o(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return o(240|t>>>18&7)+o(128|t>>>12&63)+o(128|t>>>6&63)+o(128|63&t)},d=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,u=t?e=>Buffer.from(e,"utf8").toString("base64"):n?e=>l(n.encode(e)):e=>c(e.replace(d,i)),s=(e,t=!1)=>t?a(u(e)):u(e);console.log("Hello!");const p=document.getElementById("name-list"),m=document.getElementById("submit"),f=document.getElementById("log"),h=document.getElementById("table"),g=document.getElementById("special-rules"),y=document.getElementById("show-recipients"),E=window.location.href.replace("/generator.html","");let v,C=(...e)=>{console.error(...e);let t=document.createElement("p");t.style.color="red",t.innerText=e.join(", "),f.prepend(t)},b=()=>{let e=document.querySelector('input[name="sep"]:checked').value,t=p.value;if(""==p.value)return void C("Must have at least 2 names");if(t="newline"===e?p.value.split("\n"):p.value.split(","),t.length<2)return void C("Must have at least 2 names");t=t.map((e=>e.trim()));let n=B(t);n=A(n);const r=n.map((e=>{const t={recipient:e[1],specialRules:""==g.value?null:g.value},n=`${E}?santa=${encodeURIComponent(e[0])}&data=${encodeURIComponent(s(JSON.stringify(t)))}`,r=document.createElement("span");return r.onclick=()=>{navigator.clipboard.writeText(n)},r.innerHTML=n,[e[0],r,e[1]]})),o="output";((e,t,n,r=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))}())=>{e.innerHTML="";const o=document.createElement("tr");t.forEach(((e,t)=>{const n=document.createElement("th");n.innerHTML=e,o.appendChild(n)})),e.appendChild(o),n.forEach((t=>{const n=document.createElement("tr");t.forEach(((e,t)=>{const o=document.createElement("td");o.classList.add(`${r}-item-${t}`),"object"==typeof e?o.appendChild(e):o.innerHTML=e,n.appendChild(o)})),e.appendChild(n)}))})(h,["Santa","Santa's Link (click to copy)","Recipient"],r,o),v&&y.removeEventListener("change",v),v=()=>{document.querySelectorAll(`.${o}-item-2`).forEach((e=>{e.style.display=y.checked?null:"none"}))},v(),y.addEventListener("change",v)},A=e=>e.map((e=>({value:e,sort:Math.random()}))).sort(((e,t)=>e.sort-t.sort)).map((({value:e})=>e)),B=e=>{let t=A(e);return t.map(((e,n)=>t[n+1]?[e,t[n+1]]:[e,t[0]]))};m.addEventListener("click",(()=>{b()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdG9yLmJ1bmRsZS5qcyIsIm1hcHBpbmdzIjoibUJBT0EsTUNVTUEsRUFBMkIsbUJBQVRDLEtBQ2xCQyxFQUErQixtQkFBWEMsT0FFcEJDLEdBRDZCLG1CQUFoQkMsYUFBNkIsSUFBSUEsWUFDakIsbUJBQWhCQyxZQUE2QixJQUFJQSxpQkFBZ0JDLEdBRTlEQyxFQUFTQyxNQUFNQyxVQUFVQyxNQUFNQyxLQUR2QixxRUFRUkMsR0FOUyxDQUFFQyxJQUNiLElBQUlDLEVBQU0sR0FDVkQsRUFBRUUsU0FBUSxDQUFDQyxFQUFHQyxJQUFNSCxFQUFJRSxHQUFLQyxLQUZsQixDQUlaVixHQUVhVyxPQUFPQyxhQUFhQyxLQUFLRixTQUluQ0csR0FIc0MsbUJBQXBCQyxXQUFXQyxNQUM3QkQsV0FBV0MsS0FBS0gsS0FBS0UsWUFFUEUsR0FBUUEsRUFDdkJDLFFBQVEsS0FBTSxJQUFJQSxRQUFRLFVBQVdDLEdBQWEsS0FBTkEsRUFBWSxJQUFNLE9BMkI3REMsRUFBUTVCLEVBQVk2QixHQUFRNUIsS0FBSzRCLEdBQ2pDM0IsRUFBYzJCLEdBQVExQixPQUFPcUIsS0FBS0ssRUFBSyxVQUFVQyxTQUFTLFVBdkIxQ0QsSUFFbEIsSUFBSUUsRUFBS0MsRUFBSUMsRUFBSUMsRUFBSUMsRUFBTSxHQUMzQixNQUFNQyxFQUFNUCxFQUFJUSxPQUFTLEVBQ3pCLElBQUssSUFBSW5CLEVBQUksRUFBR0EsRUFBSVcsRUFBSVEsUUFBUyxDQUM3QixJQUFLTCxFQUFLSCxFQUFJUyxXQUFXcEIsTUFBUSxNQUM1QmUsRUFBS0osRUFBSVMsV0FBV3BCLE1BQVEsTUFDNUJnQixFQUFLTCxFQUFJUyxXQUFXcEIsTUFBUSxJQUM3QixNQUFNLElBQUlxQixVQUFVLDJCQUN4QlIsRUFBT0MsR0FBTSxHQUFPQyxHQUFNLEVBQUtDLEVBQy9CQyxHQUFPM0IsRUFBT3VCLEdBQU8sR0FBSyxJQUNwQnZCLEVBQU91QixHQUFPLEdBQUssSUFDbkJ2QixFQUFPdUIsR0FBTyxFQUFJLElBQ2xCdkIsRUFBYSxHQUFOdUIsR0FFakIsT0FBT0ssRUFBTUQsRUFBSXhCLE1BQU0sRUFBR3lCLEVBQU0sR0FBSyxNQUFNSSxVQUFVSixHQUFPRCxHQVUxRE0sRUFBa0J2QyxFQUNqQndDLEdBQVF2QyxPQUFPcUIsS0FBS2tCLEdBQUtaLFNBQVMsVUFDbENZLElBR0MsSUFBSUMsRUFBTyxHQUNYLElBQUssSUFBSXpCLEVBQUksRUFBRzBCLEVBQUlGLEVBQUlMLE9BQVFuQixFQUFJMEIsRUFBRzFCLEdBRnZCLEtBR1p5QixFQUFLRSxLQUFLaEMsRUFBUWlDLE1BQU0sS0FBTUosRUFBSUssU0FBUzdCLEVBQUdBLEVBSGxDLFFBS2hCLE9BQU9VLEVBQU1lLEVBQUtLLEtBQUssTUFXekJDLEVBQVdoQyxJQUNiLEdBQUlBLEVBQUVvQixPQUFTLEVBRVgsT0FESWEsRUFBS2pDLEVBQUVxQixXQUFXLElBQ1YsSUFBT3JCLEVBQ2JpQyxFQUFLLEtBQVNyQyxFQUFRLElBQVFxQyxJQUFPLEdBQ2pDckMsRUFBUSxJQUFhLEdBQUxxQyxHQUNmckMsRUFBUSxJQUFTcUMsSUFBTyxHQUFNLElBQzNCckMsRUFBUSxJQUFTcUMsSUFBTyxFQUFLLElBQzdCckMsRUFBUSxJQUFhLEdBQUxxQyxHQUc5QixJQUFJQSxFQUFLLE1BQzBCLE1BQTVCakMsRUFBRXFCLFdBQVcsR0FBSyxRQUNsQnJCLEVBQUVxQixXQUFXLEdBQUssT0FDekIsT0FBUXpCLEVBQVEsSUFBU3FDLElBQU8sR0FBTSxHQUNoQ3JDLEVBQVEsSUFBU3FDLElBQU8sR0FBTSxJQUM5QnJDLEVBQVEsSUFBU3FDLElBQU8sRUFBSyxJQUM3QnJDLEVBQVEsSUFBYSxHQUFMcUMsSUFHeEJDLEVBQVUsZ0RBUVZDLEVBQVVsRCxFQUNUbUQsR0FBTWxELE9BQU9xQixLQUFLNkIsRUFBRyxRQUFRdkIsU0FBUyxVQUN2QzFCLEVBQ0tpRCxHQUFNWixFQUFnQnJDLEVBQUlrRCxPQUFPRCxJQUNqQ0EsR0FBTXpCLEVBQVd5QixFQU5OM0IsUUFBUXlCLEVBQVNGLElBNklqQ00sRUFqSVMsQ0FBQzlCLEVBQUsrQixHQUFVLElBQVVBLEVBQ25DbEMsRUFBVzhCLEVBQVEzQixJQUNuQjJCLEVBQVEzQixHQ3ZIZGdDLFFBQVFDLElBQUksVUFHWixNQUFNQyxFQUFXQyxTQUFTQyxlQUFlLGFBQ25DQyxFQUFpQkYsU0FBU0MsZUFBZSxVQUN6Q0gsRUFBTUUsU0FBU0MsZUFBZSxPQUM5QkUsRUFBUUgsU0FBU0MsZUFBZSxTQUNoQ0csRUFBZUosU0FBU0MsZUFBZSxpQkFDdkNJLEVBQWlCTCxTQUFTQyxlQUFlLG1CQUd6Q0ssRUFBV0MsT0FBT0MsU0FBU0MsS0FBSzNDLFFBQVEsa0JBQW1CLElBSWpFLElBa0RJNEMsRUEzQ0FDLEVBQVEsSUFBSUMsS0FDWmYsUUFBUWMsU0FBU0MsR0FDakIsSUFBSUMsRUFBTWIsU0FBU2MsY0FBYyxLQUNqQ0QsRUFBSUUsTUFBTUMsTUFBTSxNQUNoQkgsRUFBSUksVUFBWUwsRUFBS3hCLEtBQUssTUFDMUJVLEVBQUlvQixRQUFRTCxJQXdDWk0sRUFBVyxLQUNYLElBQUlDLEVBQU1wQixTQUFTcUIsY0FBYyw2QkFBNkJDLE1BRTFEQyxFQUFReEIsRUFBU3VCLE1BQ3JCLEdBQXFCLElBQWxCdkIsRUFBU3VCLE1BRVIsWUFEQVgsRUFBTSw4QkFhVixHQU5JWSxFQURPLFlBQVJILEVBQ1NyQixFQUFTdUIsTUFBTUUsTUFBTSxNQUVyQnpCLEVBQVN1QixNQUFNRSxNQUFNLEtBSTlCRCxFQUFNOUMsT0FBUyxFQUVkLFlBREFrQyxFQUFNLDhCQUtWWSxFQUFRQSxFQUFNRSxLQUFLQyxHQUNSQSxFQUFLQyxTQUtoQixJQUFJQyxFQUFRQyxFQUFjTixHQUUxQkssRUFBUUUsRUFBUUYsR0FFaEIsTUFBTUcsRUFBV0gsRUFBTUgsS0FBS08sSUFDeEIsTUFBTUMsRUFBTyxDQUNUQyxVQUFXRixFQUFLLEdBQ2hCNUIsYUFBbUMsSUFBcEJBLEVBQWFrQixNQUFXLEtBQUtsQixFQUFha0IsT0FHdkRhLEVBQU8sR0FBRzdCLFdBQWtCOEIsbUJBQW1CSixFQUFLLFlBQVlJLG1CQUFtQixFQUFjQyxLQUFLQyxVQUFVTCxPQUVoSE0sRUFBT3ZDLFNBQVNjLGNBQWMsUUFNcEMsT0FMQXlCLEVBQUtDLFFBQVUsS0FDWEMsVUFBVUMsVUFBVUMsVUFBVVIsSUFFbENJLEVBQUtLLFVBQVlULEVBRVYsQ0FBQ0gsRUFBSyxHQUFJTyxFQUFNUCxFQUFLLE9BSTFCYSxFQUFLLFNBeEZLLEVBQUMxQyxFQUFPMkMsRUFBU2IsRUFBTVksRUZuQ3BDLFdBQ0gsT0FBUSxDQUFDLE1BQU0sS0FBSyxLQUFLLEtBQUssTUFBTS9FLFFBQVEsVUFBVVQsSUFDbkRBLEVBQUkwRixPQUFPQyxnQkFBZ0IsSUFBSXJGLFdBQVcsSUFBSSxHQUFLLElBQU1OLEVBQUksR0FBR2EsU0FBUyxNRWlDbEMrRSxNQUUxQzlDLEVBQU15QyxVQUFZLEdBRWxCLE1BQU1NLEVBQUtsRCxTQUFTYyxjQUFjLE1BRWxDZ0MsRUFBUTFGLFNBQVEsQ0FBQytGLEVBQVNDLEtBQ3RCLE1BQU1DLEVBQUtyRCxTQUFTYyxjQUFjLE1BQ2xDdUMsRUFBR1QsVUFBWU8sRUFDZkQsRUFBR0ksWUFBWUQsTUFHbkJsRCxFQUFNbUQsWUFBWUosR0FJbEJqQixFQUFLN0UsU0FBU21HLElBQ1YsTUFBTUwsRUFBS2xELFNBQVNjLGNBQWMsTUFDbEN5QyxFQUFJbkcsU0FBUSxDQUFDb0csRUFBTUosS0FDZixNQUFNSyxFQUFLekQsU0FBU2MsY0FBYyxNQUNsQzJDLEVBQUdDLFVBQVVDLElBQUksR0FBR2QsVUFBV08sS0FDYixpQkFBUkksRUFDTkMsRUFBR0gsWUFBWUUsR0FFZkMsRUFBR2IsVUFBWVksRUFHbkJOLEVBQUdJLFlBQVlHLE1BRW5CdEQsRUFBTW1ELFlBQVlKLE9BNER0QlUsQ0FBY3pELEVBQU8sQ0FBQyxRQUFTLCtCQUFnQyxhQUFjNEIsRUFBVWMsR0FHcEZuQyxHQUNDTCxFQUFld0Qsb0JBQW9CLFNBQVVuRCxHQUlqREEsRUFBdUIsS0FDTlYsU0FBUzhELGlCQUFpQixJQUFJakIsWUFDdEN6RixTQUFReUQsSUFFVEEsRUFBSUUsTUFBTWdELFFBQVcxRCxFQUFzQixRQUFFLEtBQUssV0FHMURLLElBQ0FMLEVBQWUyRCxpQkFBaUIsU0FBVXRELElBTTFDb0IsRUFBV21DLEdBQ0pBLEVBQ0Z4QyxLQUFLSCxJQUFVLENBQUdBLE1BQUFBLEVBQU80QyxLQUFNQyxLQUFLQyxhQUNwQ0YsTUFBSyxDQUFDaEgsRUFBR21ILElBQU1uSCxFQUFFZ0gsS0FBT0csRUFBRUgsT0FDMUJ6QyxLQUFJLEVBQUdILE1BQUFBLEtBQVlBLElBR3hCTyxFQUFpQnlDLElBQ2pCLElBQUlDLEVBQVd6QyxFQUFRd0MsR0FRdkIsT0FQWUMsRUFBUzlDLEtBQUksQ0FBQ0gsRUFBTzhCLElBQ3pCbUIsRUFBU25CLEVBQU0sR0FHWixDQUFDOUIsRUFBT2lELEVBQVNuQixFQUFNLElBRm5CLENBQUM5QixFQUFPaUQsRUFBUyxPQVdwQ3JFLEVBQWU4RCxpQkFBaUIsU0FBUyxLQUVyQzdDLFEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZWNyZXQtc2FudGEvLi9zcmMvY29tbW9uLmpzIiwid2VicGFjazovL3NlY3JldC1zYW50YS8uL25vZGVfbW9kdWxlcy9qcy1iYXNlNjQvYmFzZTY0Lm1qcyIsIndlYnBhY2s6Ly9zZWNyZXQtc2FudGEvLi9zcmMvZ2VuZXJhdG9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGV4cG9ydCBjb25zdCBCYXNlNjQ9e19rZXlTdHI6XCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPVwiLGVuY29kZTpmdW5jdGlvbihlKXt2YXIgdD1cIlwiO3ZhciBuLHIsaSxzLG8sdSxhO3ZhciBmPTA7ZT1CYXNlNjQuX3V0ZjhfZW5jb2RlKGUpO3doaWxlKGY8ZS5sZW5ndGgpe249ZS5jaGFyQ29kZUF0KGYrKyk7cj1lLmNoYXJDb2RlQXQoZisrKTtpPWUuY2hhckNvZGVBdChmKyspO3M9bj4+MjtvPShuJjMpPDw0fHI+PjQ7dT0ociYxNSk8PDJ8aT4+NjthPWkmNjM7aWYoaXNOYU4ocikpe3U9YT02NH1lbHNlIGlmKGlzTmFOKGkpKXthPTY0fXQ9dCt0aGlzLl9rZXlTdHIuY2hhckF0KHMpK3RoaXMuX2tleVN0ci5jaGFyQXQobykrdGhpcy5fa2V5U3RyLmNoYXJBdCh1KSt0aGlzLl9rZXlTdHIuY2hhckF0KGEpfXJldHVybiB0fSxkZWNvZGU6ZnVuY3Rpb24oZSl7dmFyIHQ9XCJcIjt2YXIgbixyLGk7dmFyIHMsbyx1LGE7dmFyIGY9MDtlPWUucmVwbGFjZSgvW15BLVphLXowLTlcXCtcXC9cXD1dL2csXCJcIik7d2hpbGUoZjxlLmxlbmd0aCl7cz10aGlzLl9rZXlTdHIuaW5kZXhPZihlLmNoYXJBdChmKyspKTtvPXRoaXMuX2tleVN0ci5pbmRleE9mKGUuY2hhckF0KGYrKykpO3U9dGhpcy5fa2V5U3RyLmluZGV4T2YoZS5jaGFyQXQoZisrKSk7YT10aGlzLl9rZXlTdHIuaW5kZXhPZihlLmNoYXJBdChmKyspKTtuPXM8PDJ8bz4+NDtyPShvJjE1KTw8NHx1Pj4yO2k9KHUmMyk8PDZ8YTt0PXQrU3RyaW5nLmZyb21DaGFyQ29kZShuKTtpZih1IT02NCl7dD10K1N0cmluZy5mcm9tQ2hhckNvZGUocil9aWYoYSE9NjQpe3Q9dCtTdHJpbmcuZnJvbUNoYXJDb2RlKGkpfX10PUJhc2U2NC5fdXRmOF9kZWNvZGUodCk7cmV0dXJuIHR9LF91dGY4X2VuY29kZTpmdW5jdGlvbihlKXtlPWUucmVwbGFjZSgvXFxyXFxuL2csXCJcXG5cIik7dmFyIHQ9XCJcIjtmb3IodmFyIG49MDtuPGUubGVuZ3RoO24rKyl7dmFyIHI9ZS5jaGFyQ29kZUF0KG4pO2lmKHI8MTI4KXt0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKHIpfWVsc2UgaWYocj4xMjcmJnI8MjA0OCl7dCs9U3RyaW5nLmZyb21DaGFyQ29kZShyPj42fDE5Mik7dCs9U3RyaW5nLmZyb21DaGFyQ29kZShyJjYzfDEyOCl9ZWxzZXt0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKHI+PjEyfDIyNCk7dCs9U3RyaW5nLmZyb21DaGFyQ29kZShyPj42JjYzfDEyOCk7dCs9U3RyaW5nLmZyb21DaGFyQ29kZShyJjYzfDEyOCl9fXJldHVybiB0fSxfdXRmOF9kZWNvZGU6ZnVuY3Rpb24oZSl7dmFyIHQ9XCJcIjt2YXIgbj0wO3ZhciByPWMxPWMyPTA7d2hpbGUobjxlLmxlbmd0aCl7cj1lLmNoYXJDb2RlQXQobik7aWYocjwxMjgpe3QrPVN0cmluZy5mcm9tQ2hhckNvZGUocik7bisrfWVsc2UgaWYocj4xOTEmJnI8MjI0KXtjMj1lLmNoYXJDb2RlQXQobisxKTt0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKChyJjMxKTw8NnxjMiY2Myk7bis9Mn1lbHNle2MyPWUuY2hhckNvZGVBdChuKzEpO2MzPWUuY2hhckNvZGVBdChuKzIpO3QrPVN0cmluZy5mcm9tQ2hhckNvZGUoKHImMTUpPDwxMnwoYzImNjMpPDw2fGMzJjYzKTtuKz0zfX1yZXR1cm4gdH19XG5leHBvcnQgZnVuY3Rpb24gdXVpZHY0KCkge1xuICAgIHJldHVybiAoWzFlN10rLTFlMystNGUzKy04ZTMrLTFlMTEpLnJlcGxhY2UoL1swMThdL2csIGMgPT5cbiAgICAgIChjIF4gY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheSgxKSlbMF0gJiAxNSA+PiBjIC8gNCkudG9TdHJpbmcoMTYpXG4gICAgKTtcbiAgfVxuXG5leHBvcnQgZGVmYXVsdCB7dXVpZHY0OiB1dWlkdjR9IiwiLyoqXG4gKiAgYmFzZTY0LnRzXG4gKlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBCU0QgMy1DbGF1c2UgTGljZW5zZS5cbiAqICAgIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9CU0QtMy1DbGF1c2VcbiAqXG4gKiAgUmVmZXJlbmNlczpcbiAqICAgIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQmFzZTY0XG4gKlxuICogQGF1dGhvciBEYW4gS29nYWkgKGh0dHBzOi8vZ2l0aHViLmNvbS9kYW5rb2dhaSlcbiAqL1xuY29uc3QgdmVyc2lvbiA9ICczLjcuMic7XG4vKipcbiAqIEBkZXByZWNhdGVkIHVzZSBsb3dlcmNhc2UgYHZlcnNpb25gLlxuICovXG5jb25zdCBWRVJTSU9OID0gdmVyc2lvbjtcbmNvbnN0IF9oYXNhdG9iID0gdHlwZW9mIGF0b2IgPT09ICdmdW5jdGlvbic7XG5jb25zdCBfaGFzYnRvYSA9IHR5cGVvZiBidG9hID09PSAnZnVuY3Rpb24nO1xuY29uc3QgX2hhc0J1ZmZlciA9IHR5cGVvZiBCdWZmZXIgPT09ICdmdW5jdGlvbic7XG5jb25zdCBfVEQgPSB0eXBlb2YgVGV4dERlY29kZXIgPT09ICdmdW5jdGlvbicgPyBuZXcgVGV4dERlY29kZXIoKSA6IHVuZGVmaW5lZDtcbmNvbnN0IF9URSA9IHR5cGVvZiBUZXh0RW5jb2RlciA9PT0gJ2Z1bmN0aW9uJyA/IG5ldyBUZXh0RW5jb2RlcigpIDogdW5kZWZpbmVkO1xuY29uc3QgYjY0Y2ggPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0nO1xuY29uc3QgYjY0Y2hzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYjY0Y2gpO1xuY29uc3QgYjY0dGFiID0gKChhKSA9PiB7XG4gICAgbGV0IHRhYiA9IHt9O1xuICAgIGEuZm9yRWFjaCgoYywgaSkgPT4gdGFiW2NdID0gaSk7XG4gICAgcmV0dXJuIHRhYjtcbn0pKGI2NGNocyk7XG5jb25zdCBiNjRyZSA9IC9eKD86W0EtWmEtelxcZCtcXC9dezR9KSo/KD86W0EtWmEtelxcZCtcXC9dezJ9KD86PT0pP3xbQS1aYS16XFxkK1xcL117M309Pyk/JC87XG5jb25zdCBfZnJvbUNDID0gU3RyaW5nLmZyb21DaGFyQ29kZS5iaW5kKFN0cmluZyk7XG5jb25zdCBfVThBZnJvbSA9IHR5cGVvZiBVaW50OEFycmF5LmZyb20gPT09ICdmdW5jdGlvbidcbiAgICA/IFVpbnQ4QXJyYXkuZnJvbS5iaW5kKFVpbnQ4QXJyYXkpXG4gICAgOiAoaXQsIGZuID0gKHgpID0+IHgpID0+IG5ldyBVaW50OEFycmF5KEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGl0LCAwKS5tYXAoZm4pKTtcbmNvbnN0IF9ta1VyaVNhZmUgPSAoc3JjKSA9PiBzcmNcbiAgICAucmVwbGFjZSgvPS9nLCAnJykucmVwbGFjZSgvWytcXC9dL2csIChtMCkgPT4gbTAgPT0gJysnID8gJy0nIDogJ18nKTtcbmNvbnN0IF90aWR5QjY0ID0gKHMpID0+IHMucmVwbGFjZSgvW15BLVphLXowLTlcXCtcXC9dL2csICcnKTtcbi8qKlxuICogcG9seWZpbGwgdmVyc2lvbiBvZiBgYnRvYWBcbiAqL1xuY29uc3QgYnRvYVBvbHlmaWxsID0gKGJpbikgPT4ge1xuICAgIC8vIGNvbnNvbGUubG9nKCdwb2x5ZmlsbGVkJyk7XG4gICAgbGV0IHUzMiwgYzAsIGMxLCBjMiwgYXNjID0gJyc7XG4gICAgY29uc3QgcGFkID0gYmluLmxlbmd0aCAlIDM7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaW4ubGVuZ3RoOykge1xuICAgICAgICBpZiAoKGMwID0gYmluLmNoYXJDb2RlQXQoaSsrKSkgPiAyNTUgfHxcbiAgICAgICAgICAgIChjMSA9IGJpbi5jaGFyQ29kZUF0KGkrKykpID4gMjU1IHx8XG4gICAgICAgICAgICAoYzIgPSBiaW4uY2hhckNvZGVBdChpKyspKSA+IDI1NSlcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2ludmFsaWQgY2hhcmFjdGVyIGZvdW5kJyk7XG4gICAgICAgIHUzMiA9IChjMCA8PCAxNikgfCAoYzEgPDwgOCkgfCBjMjtcbiAgICAgICAgYXNjICs9IGI2NGNoc1t1MzIgPj4gMTggJiA2M11cbiAgICAgICAgICAgICsgYjY0Y2hzW3UzMiA+PiAxMiAmIDYzXVxuICAgICAgICAgICAgKyBiNjRjaHNbdTMyID4+IDYgJiA2M11cbiAgICAgICAgICAgICsgYjY0Y2hzW3UzMiAmIDYzXTtcbiAgICB9XG4gICAgcmV0dXJuIHBhZCA/IGFzYy5zbGljZSgwLCBwYWQgLSAzKSArIFwiPT09XCIuc3Vic3RyaW5nKHBhZCkgOiBhc2M7XG59O1xuLyoqXG4gKiBkb2VzIHdoYXQgYHdpbmRvdy5idG9hYCBvZiB3ZWIgYnJvd3NlcnMgZG8uXG4gKiBAcGFyYW0ge1N0cmluZ30gYmluIGJpbmFyeSBzdHJpbmdcbiAqIEByZXR1cm5zIHtzdHJpbmd9IEJhc2U2NC1lbmNvZGVkIHN0cmluZ1xuICovXG5jb25zdCBfYnRvYSA9IF9oYXNidG9hID8gKGJpbikgPT4gYnRvYShiaW4pXG4gICAgOiBfaGFzQnVmZmVyID8gKGJpbikgPT4gQnVmZmVyLmZyb20oYmluLCAnYmluYXJ5JykudG9TdHJpbmcoJ2Jhc2U2NCcpXG4gICAgICAgIDogYnRvYVBvbHlmaWxsO1xuY29uc3QgX2Zyb21VaW50OEFycmF5ID0gX2hhc0J1ZmZlclxuICAgID8gKHU4YSkgPT4gQnVmZmVyLmZyb20odThhKS50b1N0cmluZygnYmFzZTY0JylcbiAgICA6ICh1OGEpID0+IHtcbiAgICAgICAgLy8gY2YuIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEyNzEwMDAxL2hvdy10by1jb252ZXJ0LXVpbnQ4LWFycmF5LXRvLWJhc2U2NC1lbmNvZGVkLXN0cmluZy8xMjcxMzMyNiMxMjcxMzMyNlxuICAgICAgICBjb25zdCBtYXhhcmdzID0gMHgxMDAwO1xuICAgICAgICBsZXQgc3RycyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHU4YS5sZW5ndGg7IGkgPCBsOyBpICs9IG1heGFyZ3MpIHtcbiAgICAgICAgICAgIHN0cnMucHVzaChfZnJvbUNDLmFwcGx5KG51bGwsIHU4YS5zdWJhcnJheShpLCBpICsgbWF4YXJncykpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX2J0b2Eoc3Rycy5qb2luKCcnKSk7XG4gICAgfTtcbi8qKlxuICogY29udmVydHMgYSBVaW50OEFycmF5IHRvIGEgQmFzZTY0IHN0cmluZy5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW3VybHNhZmVdIFVSTC1hbmQtZmlsZW5hbWUtc2FmZSBhIGxhIFJGQzQ2NDggwqc1XG4gKiBAcmV0dXJucyB7c3RyaW5nfSBCYXNlNjQgc3RyaW5nXG4gKi9cbmNvbnN0IGZyb21VaW50OEFycmF5ID0gKHU4YSwgdXJsc2FmZSA9IGZhbHNlKSA9PiB1cmxzYWZlID8gX21rVXJpU2FmZShfZnJvbVVpbnQ4QXJyYXkodThhKSkgOiBfZnJvbVVpbnQ4QXJyYXkodThhKTtcbi8vIFRoaXMgdHJpY2sgaXMgZm91bmQgYnJva2VuIGh0dHBzOi8vZ2l0aHViLmNvbS9kYW5rb2dhaS9qcy1iYXNlNjQvaXNzdWVzLzEzMFxuLy8gY29uc3QgdXRvYiA9IChzcmM6IHN0cmluZykgPT4gdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHNyYykpO1xuLy8gcmV2ZXJ0aW5nIGdvb2Qgb2xkIGZhdGlvbmVkIHJlZ2V4cFxuY29uc3QgY2JfdXRvYiA9IChjKSA9PiB7XG4gICAgaWYgKGMubGVuZ3RoIDwgMikge1xuICAgICAgICB2YXIgY2MgPSBjLmNoYXJDb2RlQXQoMCk7XG4gICAgICAgIHJldHVybiBjYyA8IDB4ODAgPyBjXG4gICAgICAgICAgICA6IGNjIDwgMHg4MDAgPyAoX2Zyb21DQygweGMwIHwgKGNjID4+PiA2KSlcbiAgICAgICAgICAgICAgICArIF9mcm9tQ0MoMHg4MCB8IChjYyAmIDB4M2YpKSlcbiAgICAgICAgICAgICAgICA6IChfZnJvbUNDKDB4ZTAgfCAoKGNjID4+PiAxMikgJiAweDBmKSlcbiAgICAgICAgICAgICAgICAgICAgKyBfZnJvbUNDKDB4ODAgfCAoKGNjID4+PiA2KSAmIDB4M2YpKVxuICAgICAgICAgICAgICAgICAgICArIF9mcm9tQ0MoMHg4MCB8IChjYyAmIDB4M2YpKSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgY2MgPSAweDEwMDAwXG4gICAgICAgICAgICArIChjLmNoYXJDb2RlQXQoMCkgLSAweEQ4MDApICogMHg0MDBcbiAgICAgICAgICAgICsgKGMuY2hhckNvZGVBdCgxKSAtIDB4REMwMCk7XG4gICAgICAgIHJldHVybiAoX2Zyb21DQygweGYwIHwgKChjYyA+Pj4gMTgpICYgMHgwNykpXG4gICAgICAgICAgICArIF9mcm9tQ0MoMHg4MCB8ICgoY2MgPj4+IDEyKSAmIDB4M2YpKVxuICAgICAgICAgICAgKyBfZnJvbUNDKDB4ODAgfCAoKGNjID4+PiA2KSAmIDB4M2YpKVxuICAgICAgICAgICAgKyBfZnJvbUNDKDB4ODAgfCAoY2MgJiAweDNmKSkpO1xuICAgIH1cbn07XG5jb25zdCByZV91dG9iID0gL1tcXHVEODAwLVxcdURCRkZdW1xcdURDMDAtXFx1REZGRkZdfFteXFx4MDAtXFx4N0ZdL2c7XG4vKipcbiAqIEBkZXByZWNhdGVkIHNob3VsZCBoYXZlIGJlZW4gaW50ZXJuYWwgdXNlIG9ubHkuXG4gKiBAcGFyYW0ge3N0cmluZ30gc3JjIFVURi04IHN0cmluZ1xuICogQHJldHVybnMge3N0cmluZ30gVVRGLTE2IHN0cmluZ1xuICovXG5jb25zdCB1dG9iID0gKHUpID0+IHUucmVwbGFjZShyZV91dG9iLCBjYl91dG9iKTtcbi8vXG5jb25zdCBfZW5jb2RlID0gX2hhc0J1ZmZlclxuICAgID8gKHMpID0+IEJ1ZmZlci5mcm9tKHMsICd1dGY4JykudG9TdHJpbmcoJ2Jhc2U2NCcpXG4gICAgOiBfVEVcbiAgICAgICAgPyAocykgPT4gX2Zyb21VaW50OEFycmF5KF9URS5lbmNvZGUocykpXG4gICAgICAgIDogKHMpID0+IF9idG9hKHV0b2IocykpO1xuLyoqXG4gKiBjb252ZXJ0cyBhIFVURi04LWVuY29kZWQgc3RyaW5nIHRvIGEgQmFzZTY0IHN0cmluZy5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW3VybHNhZmVdIGlmIGB0cnVlYCBtYWtlIHRoZSByZXN1bHQgVVJMLXNhZmVcbiAqIEByZXR1cm5zIHtzdHJpbmd9IEJhc2U2NCBzdHJpbmdcbiAqL1xuY29uc3QgZW5jb2RlID0gKHNyYywgdXJsc2FmZSA9IGZhbHNlKSA9PiB1cmxzYWZlXG4gICAgPyBfbWtVcmlTYWZlKF9lbmNvZGUoc3JjKSlcbiAgICA6IF9lbmNvZGUoc3JjKTtcbi8qKlxuICogY29udmVydHMgYSBVVEYtOC1lbmNvZGVkIHN0cmluZyB0byBVUkwtc2FmZSBCYXNlNjQgUkZDNDY0OCDCpzUuXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBCYXNlNjQgc3RyaW5nXG4gKi9cbmNvbnN0IGVuY29kZVVSSSA9IChzcmMpID0+IGVuY29kZShzcmMsIHRydWUpO1xuLy8gVGhpcyB0cmljayBpcyBmb3VuZCBicm9rZW4gaHR0cHM6Ly9naXRodWIuY29tL2RhbmtvZ2FpL2pzLWJhc2U2NC9pc3N1ZXMvMTMwXG4vLyBjb25zdCBidG91ID0gKHNyYzogc3RyaW5nKSA9PiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKHNyYykpO1xuLy8gcmV2ZXJ0aW5nIGdvb2Qgb2xkIGZhdGlvbmVkIHJlZ2V4cFxuY29uc3QgcmVfYnRvdSA9IC9bXFx4QzAtXFx4REZdW1xceDgwLVxceEJGXXxbXFx4RTAtXFx4RUZdW1xceDgwLVxceEJGXXsyfXxbXFx4RjAtXFx4RjddW1xceDgwLVxceEJGXXszfS9nO1xuY29uc3QgY2JfYnRvdSA9IChjY2NjKSA9PiB7XG4gICAgc3dpdGNoIChjY2NjLmxlbmd0aCkge1xuICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICB2YXIgY3AgPSAoKDB4MDcgJiBjY2NjLmNoYXJDb2RlQXQoMCkpIDw8IDE4KVxuICAgICAgICAgICAgICAgIHwgKCgweDNmICYgY2NjYy5jaGFyQ29kZUF0KDEpKSA8PCAxMilcbiAgICAgICAgICAgICAgICB8ICgoMHgzZiAmIGNjY2MuY2hhckNvZGVBdCgyKSkgPDwgNilcbiAgICAgICAgICAgICAgICB8ICgweDNmICYgY2NjYy5jaGFyQ29kZUF0KDMpKSwgb2Zmc2V0ID0gY3AgLSAweDEwMDAwO1xuICAgICAgICAgICAgcmV0dXJuIChfZnJvbUNDKChvZmZzZXQgPj4+IDEwKSArIDB4RDgwMClcbiAgICAgICAgICAgICAgICArIF9mcm9tQ0MoKG9mZnNldCAmIDB4M0ZGKSArIDB4REMwMCkpO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICByZXR1cm4gX2Zyb21DQygoKDB4MGYgJiBjY2NjLmNoYXJDb2RlQXQoMCkpIDw8IDEyKVxuICAgICAgICAgICAgICAgIHwgKCgweDNmICYgY2NjYy5jaGFyQ29kZUF0KDEpKSA8PCA2KVxuICAgICAgICAgICAgICAgIHwgKDB4M2YgJiBjY2NjLmNoYXJDb2RlQXQoMikpKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBfZnJvbUNDKCgoMHgxZiAmIGNjY2MuY2hhckNvZGVBdCgwKSkgPDwgNilcbiAgICAgICAgICAgICAgICB8ICgweDNmICYgY2NjYy5jaGFyQ29kZUF0KDEpKSk7XG4gICAgfVxufTtcbi8qKlxuICogQGRlcHJlY2F0ZWQgc2hvdWxkIGhhdmUgYmVlbiBpbnRlcm5hbCB1c2Ugb25seS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBzcmMgVVRGLTE2IHN0cmluZ1xuICogQHJldHVybnMge3N0cmluZ30gVVRGLTggc3RyaW5nXG4gKi9cbmNvbnN0IGJ0b3UgPSAoYikgPT4gYi5yZXBsYWNlKHJlX2J0b3UsIGNiX2J0b3UpO1xuLyoqXG4gKiBwb2x5ZmlsbCB2ZXJzaW9uIG9mIGBhdG9iYFxuICovXG5jb25zdCBhdG9iUG9seWZpbGwgPSAoYXNjKSA9PiB7XG4gICAgLy8gY29uc29sZS5sb2coJ3BvbHlmaWxsZWQnKTtcbiAgICBhc2MgPSBhc2MucmVwbGFjZSgvXFxzKy9nLCAnJyk7XG4gICAgaWYgKCFiNjRyZS50ZXN0KGFzYykpXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ21hbGZvcm1lZCBiYXNlNjQuJyk7XG4gICAgYXNjICs9ICc9PScuc2xpY2UoMiAtIChhc2MubGVuZ3RoICYgMykpO1xuICAgIGxldCB1MjQsIGJpbiA9ICcnLCByMSwgcjI7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhc2MubGVuZ3RoOykge1xuICAgICAgICB1MjQgPSBiNjR0YWJbYXNjLmNoYXJBdChpKyspXSA8PCAxOFxuICAgICAgICAgICAgfCBiNjR0YWJbYXNjLmNoYXJBdChpKyspXSA8PCAxMlxuICAgICAgICAgICAgfCAocjEgPSBiNjR0YWJbYXNjLmNoYXJBdChpKyspXSkgPDwgNlxuICAgICAgICAgICAgfCAocjIgPSBiNjR0YWJbYXNjLmNoYXJBdChpKyspXSk7XG4gICAgICAgIGJpbiArPSByMSA9PT0gNjQgPyBfZnJvbUNDKHUyNCA+PiAxNiAmIDI1NSlcbiAgICAgICAgICAgIDogcjIgPT09IDY0ID8gX2Zyb21DQyh1MjQgPj4gMTYgJiAyNTUsIHUyNCA+PiA4ICYgMjU1KVxuICAgICAgICAgICAgICAgIDogX2Zyb21DQyh1MjQgPj4gMTYgJiAyNTUsIHUyNCA+PiA4ICYgMjU1LCB1MjQgJiAyNTUpO1xuICAgIH1cbiAgICByZXR1cm4gYmluO1xufTtcbi8qKlxuICogZG9lcyB3aGF0IGB3aW5kb3cuYXRvYmAgb2Ygd2ViIGJyb3dzZXJzIGRvLlxuICogQHBhcmFtIHtTdHJpbmd9IGFzYyBCYXNlNjQtZW5jb2RlZCBzdHJpbmdcbiAqIEByZXR1cm5zIHtzdHJpbmd9IGJpbmFyeSBzdHJpbmdcbiAqL1xuY29uc3QgX2F0b2IgPSBfaGFzYXRvYiA/IChhc2MpID0+IGF0b2IoX3RpZHlCNjQoYXNjKSlcbiAgICA6IF9oYXNCdWZmZXIgPyAoYXNjKSA9PiBCdWZmZXIuZnJvbShhc2MsICdiYXNlNjQnKS50b1N0cmluZygnYmluYXJ5JylcbiAgICAgICAgOiBhdG9iUG9seWZpbGw7XG4vL1xuY29uc3QgX3RvVWludDhBcnJheSA9IF9oYXNCdWZmZXJcbiAgICA/IChhKSA9PiBfVThBZnJvbShCdWZmZXIuZnJvbShhLCAnYmFzZTY0JykpXG4gICAgOiAoYSkgPT4gX1U4QWZyb20oX2F0b2IoYSksIGMgPT4gYy5jaGFyQ29kZUF0KDApKTtcbi8qKlxuICogY29udmVydHMgYSBCYXNlNjQgc3RyaW5nIHRvIGEgVWludDhBcnJheS5cbiAqL1xuY29uc3QgdG9VaW50OEFycmF5ID0gKGEpID0+IF90b1VpbnQ4QXJyYXkoX3VuVVJJKGEpKTtcbi8vXG5jb25zdCBfZGVjb2RlID0gX2hhc0J1ZmZlclxuICAgID8gKGEpID0+IEJ1ZmZlci5mcm9tKGEsICdiYXNlNjQnKS50b1N0cmluZygndXRmOCcpXG4gICAgOiBfVERcbiAgICAgICAgPyAoYSkgPT4gX1RELmRlY29kZShfdG9VaW50OEFycmF5KGEpKVxuICAgICAgICA6IChhKSA9PiBidG91KF9hdG9iKGEpKTtcbmNvbnN0IF91blVSSSA9IChhKSA9PiBfdGlkeUI2NChhLnJlcGxhY2UoL1stX10vZywgKG0wKSA9PiBtMCA9PSAnLScgPyAnKycgOiAnLycpKTtcbi8qKlxuICogY29udmVydHMgYSBCYXNlNjQgc3RyaW5nIHRvIGEgVVRGLTggc3RyaW5nLlxuICogQHBhcmFtIHtTdHJpbmd9IHNyYyBCYXNlNjQgc3RyaW5nLiAgQm90aCBub3JtYWwgYW5kIFVSTC1zYWZlIGFyZSBzdXBwb3J0ZWRcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFVURi04IHN0cmluZ1xuICovXG5jb25zdCBkZWNvZGUgPSAoc3JjKSA9PiBfZGVjb2RlKF91blVSSShzcmMpKTtcbi8qKlxuICogY2hlY2sgaWYgYSB2YWx1ZSBpcyBhIHZhbGlkIEJhc2U2NCBzdHJpbmdcbiAqIEBwYXJhbSB7U3RyaW5nfSBzcmMgYSB2YWx1ZSB0byBjaGVja1xuICAqL1xuY29uc3QgaXNWYWxpZCA9IChzcmMpID0+IHtcbiAgICBpZiAodHlwZW9mIHNyYyAhPT0gJ3N0cmluZycpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCBzID0gc3JjLnJlcGxhY2UoL1xccysvZywgJycpLnJlcGxhY2UoLz17MCwyfSQvLCAnJyk7XG4gICAgcmV0dXJuICEvW15cXHMwLTlhLXpBLVpcXCsvXS8udGVzdChzKSB8fCAhL1teXFxzMC05YS16QS1aXFwtX10vLnRlc3Qocyk7XG59O1xuLy9cbmNvbnN0IF9ub0VudW0gPSAodikgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICAgIHZhbHVlOiB2LCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH07XG59O1xuLyoqXG4gKiBleHRlbmQgU3RyaW5nLnByb3RvdHlwZSB3aXRoIHJlbGV2YW50IG1ldGhvZHNcbiAqL1xuY29uc3QgZXh0ZW5kU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IF9hZGQgPSAobmFtZSwgYm9keSkgPT4gT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZy5wcm90b3R5cGUsIG5hbWUsIF9ub0VudW0oYm9keSkpO1xuICAgIF9hZGQoJ2Zyb21CYXNlNjQnLCBmdW5jdGlvbiAoKSB7IHJldHVybiBkZWNvZGUodGhpcyk7IH0pO1xuICAgIF9hZGQoJ3RvQmFzZTY0JywgZnVuY3Rpb24gKHVybHNhZmUpIHsgcmV0dXJuIGVuY29kZSh0aGlzLCB1cmxzYWZlKTsgfSk7XG4gICAgX2FkZCgndG9CYXNlNjRVUkknLCBmdW5jdGlvbiAoKSB7IHJldHVybiBlbmNvZGUodGhpcywgdHJ1ZSk7IH0pO1xuICAgIF9hZGQoJ3RvQmFzZTY0VVJMJywgZnVuY3Rpb24gKCkgeyByZXR1cm4gZW5jb2RlKHRoaXMsIHRydWUpOyB9KTtcbiAgICBfYWRkKCd0b1VpbnQ4QXJyYXknLCBmdW5jdGlvbiAoKSB7IHJldHVybiB0b1VpbnQ4QXJyYXkodGhpcyk7IH0pO1xufTtcbi8qKlxuICogZXh0ZW5kIFVpbnQ4QXJyYXkucHJvdG90eXBlIHdpdGggcmVsZXZhbnQgbWV0aG9kc1xuICovXG5jb25zdCBleHRlbmRVaW50OEFycmF5ID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IF9hZGQgPSAobmFtZSwgYm9keSkgPT4gT2JqZWN0LmRlZmluZVByb3BlcnR5KFVpbnQ4QXJyYXkucHJvdG90eXBlLCBuYW1lLCBfbm9FbnVtKGJvZHkpKTtcbiAgICBfYWRkKCd0b0Jhc2U2NCcsIGZ1bmN0aW9uICh1cmxzYWZlKSB7IHJldHVybiBmcm9tVWludDhBcnJheSh0aGlzLCB1cmxzYWZlKTsgfSk7XG4gICAgX2FkZCgndG9CYXNlNjRVUkknLCBmdW5jdGlvbiAoKSB7IHJldHVybiBmcm9tVWludDhBcnJheSh0aGlzLCB0cnVlKTsgfSk7XG4gICAgX2FkZCgndG9CYXNlNjRVUkwnLCBmdW5jdGlvbiAoKSB7IHJldHVybiBmcm9tVWludDhBcnJheSh0aGlzLCB0cnVlKTsgfSk7XG59O1xuLyoqXG4gKiBleHRlbmQgQnVpbHRpbiBwcm90b3R5cGVzIHdpdGggcmVsZXZhbnQgbWV0aG9kc1xuICovXG5jb25zdCBleHRlbmRCdWlsdGlucyA9ICgpID0+IHtcbiAgICBleHRlbmRTdHJpbmcoKTtcbiAgICBleHRlbmRVaW50OEFycmF5KCk7XG59O1xuY29uc3QgZ0Jhc2U2NCA9IHtcbiAgICB2ZXJzaW9uOiB2ZXJzaW9uLFxuICAgIFZFUlNJT046IFZFUlNJT04sXG4gICAgYXRvYjogX2F0b2IsXG4gICAgYXRvYlBvbHlmaWxsOiBhdG9iUG9seWZpbGwsXG4gICAgYnRvYTogX2J0b2EsXG4gICAgYnRvYVBvbHlmaWxsOiBidG9hUG9seWZpbGwsXG4gICAgZnJvbUJhc2U2NDogZGVjb2RlLFxuICAgIHRvQmFzZTY0OiBlbmNvZGUsXG4gICAgZW5jb2RlOiBlbmNvZGUsXG4gICAgZW5jb2RlVVJJOiBlbmNvZGVVUkksXG4gICAgZW5jb2RlVVJMOiBlbmNvZGVVUkksXG4gICAgdXRvYjogdXRvYixcbiAgICBidG91OiBidG91LFxuICAgIGRlY29kZTogZGVjb2RlLFxuICAgIGlzVmFsaWQ6IGlzVmFsaWQsXG4gICAgZnJvbVVpbnQ4QXJyYXk6IGZyb21VaW50OEFycmF5LFxuICAgIHRvVWludDhBcnJheTogdG9VaW50OEFycmF5LFxuICAgIGV4dGVuZFN0cmluZzogZXh0ZW5kU3RyaW5nLFxuICAgIGV4dGVuZFVpbnQ4QXJyYXk6IGV4dGVuZFVpbnQ4QXJyYXksXG4gICAgZXh0ZW5kQnVpbHRpbnM6IGV4dGVuZEJ1aWx0aW5zLFxufTtcbi8vIG1ha2VjanM6Q1VUIC8vXG5leHBvcnQgeyB2ZXJzaW9uIH07XG5leHBvcnQgeyBWRVJTSU9OIH07XG5leHBvcnQgeyBfYXRvYiBhcyBhdG9iIH07XG5leHBvcnQgeyBhdG9iUG9seWZpbGwgfTtcbmV4cG9ydCB7IF9idG9hIGFzIGJ0b2EgfTtcbmV4cG9ydCB7IGJ0b2FQb2x5ZmlsbCB9O1xuZXhwb3J0IHsgZGVjb2RlIGFzIGZyb21CYXNlNjQgfTtcbmV4cG9ydCB7IGVuY29kZSBhcyB0b0Jhc2U2NCB9O1xuZXhwb3J0IHsgdXRvYiB9O1xuZXhwb3J0IHsgZW5jb2RlIH07XG5leHBvcnQgeyBlbmNvZGVVUkkgfTtcbmV4cG9ydCB7IGVuY29kZVVSSSBhcyBlbmNvZGVVUkwgfTtcbmV4cG9ydCB7IGJ0b3UgfTtcbmV4cG9ydCB7IGRlY29kZSB9O1xuZXhwb3J0IHsgaXNWYWxpZCB9O1xuZXhwb3J0IHsgZnJvbVVpbnQ4QXJyYXkgfTtcbmV4cG9ydCB7IHRvVWludDhBcnJheSB9O1xuZXhwb3J0IHsgZXh0ZW5kU3RyaW5nIH07XG5leHBvcnQgeyBleHRlbmRVaW50OEFycmF5IH07XG5leHBvcnQgeyBleHRlbmRCdWlsdGlucyB9O1xuLy8gYW5kIGZpbmFsbHksXG5leHBvcnQgeyBnQmFzZTY0IGFzIEJhc2U2NCB9O1xuIiwiXG4vLyBjb25zdCB4bHN4ID0gcmVxdWlyZShcInhsc3hcIik7XG5pbXBvcnQge3V1aWR2NH0gZnJvbSBcIi4vY29tbW9uXCJcbmltcG9ydCB7IEJhc2U2NCB9IGZyb20gJ2pzLWJhc2U2NCc7XG5cbmNvbnNvbGUubG9nKFwiSGVsbG8hXCIpXG5cbi8vIGNvbnN0IGZpbGVQaWNrZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZpbGVcIilcbmNvbnN0IG5hbWVMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYW1lLWxpc3RcIilcbmNvbnN0IGdlbmVyYXRlQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdWJtaXRcIilcbmNvbnN0IGxvZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9nXCIpXG5jb25zdCB0YWJsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGFibGVcIik7XG5jb25zdCBzcGVjaWFsUnVsZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNwZWNpYWwtcnVsZXNcIik7XG5jb25zdCBzaG93UmVjaXBpZW50cyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2hvdy1yZWNpcGllbnRzXCIpXG5cblxuY29uc3QgbWFpblBhZ2UgPSB3aW5kb3cubG9jYXRpb24uaHJlZi5yZXBsYWNlKFwiL2dlbmVyYXRvci5odG1sXCIsIFwiXCIpXG5cblxuXG5sZXQgcHJpbnQgPSAoLi4uYXJncykgPT4ge1xuICAgIGNvbnNvbGUubG9nKC4uLmFyZ3MpO1xuICAgIGxldCBlbG0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICBlbG0uaW5uZXJUZXh0ID0gYXJncy5qb2luKFwiLCBcIilcbiAgICBsb2cucHJlcGVuZChlbG0pXG59XG5cbmxldCBlcnJvciA9ICguLi5hcmdzKSA9PiB7XG4gICAgY29uc29sZS5lcnJvciguLi5hcmdzKTtcbiAgICBsZXQgZWxtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG4gICAgZWxtLnN0eWxlLmNvbG9yPVwicmVkXCI7XG4gICAgZWxtLmlubmVyVGV4dCA9IGFyZ3Muam9pbihcIiwgXCIpXG4gICAgbG9nLnByZXBlbmQoZWxtKVxufVxuXG5cbmxldCB0YWJsZUdlbmVyYXRlID0gKHRhYmxlLCBoZWFkZXJzLCBkYXRhLCBpZD11dWlkdjQoKSkgPT4ge1xuXG4gICAgdGFibGUuaW5uZXJIVE1MID0gXCJcIlxuICAgIC8vZ2VuZXJhdGUgaGVhZGVyc1xuICAgIGNvbnN0IHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRyXCIpO1xuXG4gICAgaGVhZGVycy5mb3JFYWNoKChlbGVtZW50LCBpbmRleCkgPT4ge1xuICAgICAgICBjb25zdCB0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0aFwiKTtcbiAgICAgICAgdGguaW5uZXJIVE1MID0gZWxlbWVudDtcbiAgICAgICAgdHIuYXBwZW5kQ2hpbGQodGgpXG4gICAgfSk7XG5cbiAgICB0YWJsZS5hcHBlbmRDaGlsZCh0cilcbiAgICBcbiAgICAvL2dlbmVyYXRlIGJvZHlcblxuICAgIGRhdGEuZm9yRWFjaCgocm93KSA9PiB7XG4gICAgICAgIGNvbnN0IHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRyXCIpO1xuICAgICAgICByb3cuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRkXCIpO1xuICAgICAgICAgICAgdGQuY2xhc3NMaXN0LmFkZChgJHtpZH0taXRlbS0ke2luZGV4fWApXG4gICAgICAgICAgICBpZih0eXBlb2YgaXRlbSA9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAgICAgdGQuYXBwZW5kQ2hpbGQoaXRlbSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRkLmlubmVySFRNTCA9IGl0ZW07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRyLmFwcGVuZENoaWxkKHRkKVxuICAgICAgICB9KVxuICAgICAgICB0YWJsZS5hcHBlbmRDaGlsZCh0cilcbiAgICB9KVxuXG59XG5cbmxldCBzaG93UmVjaXByaWVudHNGdW5jdDtcblxubGV0IGdlbmVyYXRlID0gKCkgPT4ge1xuICAgIGxldCBzZXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwic2VwXCJdOmNoZWNrZWQnKS52YWx1ZTtcbiAgICAvL2xldCBzZXAgPSBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKFwic2VwXCIpKS5maW5kKHIgPT4gci5jaGVja2VkKS52YWx1ZTtcbiAgICBsZXQgbmFtZXMgPSBuYW1lTGlzdC52YWx1ZVxuICAgIGlmKG5hbWVMaXN0LnZhbHVlID09IFwiXCIpIHtcbiAgICAgICAgZXJyb3IoXCJNdXN0IGhhdmUgYXQgbGVhc3QgMiBuYW1lc1wiKVxuICAgICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBcbiAgICAvL3NwbGl0IHN0cmluZ1xuICAgIGlmKHNlcCA9PT0gXCJuZXdsaW5lXCIpIHtcbiAgICAgICAgbmFtZXMgPSBuYW1lTGlzdC52YWx1ZS5zcGxpdChcIlxcblwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBuYW1lcyA9IG5hbWVMaXN0LnZhbHVlLnNwbGl0KFwiLFwiKTtcbiAgICB9XG5cbiAgIFxuICAgIGlmKG5hbWVzLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgZXJyb3IoXCJNdXN0IGhhdmUgYXQgbGVhc3QgMiBuYW1lc1wiKVxuICAgICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvL2NsZWFuIHVwIHRleHQgYW5kIGdlbmVyYXRlIGxpbmtzXG4gICAgbmFtZXMgPSBuYW1lcy5tYXAoKG5hbWUpPT4ge1xuICAgICAgICByZXR1cm4gbmFtZS50cmltKCk7XG4gICAgfSlcblxuXG4gICAgXG4gICAgbGV0IHBhaXJzID0gZ2VuZXJhdGVQYWlycyhuYW1lcyk7XG5cbiAgICBwYWlycyA9IHNodWZmbGUocGFpcnMpXG5cbiAgICBjb25zdCBwYWlyTGluayA9IHBhaXJzLm1hcCgocGFpcikgPT4ge1xuICAgICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICAgICAgcmVjaXBpZW50OiBwYWlyWzFdLFxuICAgICAgICAgICAgc3BlY2lhbFJ1bGVzOiAoc3BlY2lhbFJ1bGVzLnZhbHVlPT1cIlwiKT9udWxsOnNwZWNpYWxSdWxlcy52YWx1ZVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbGluayA9IGAke21haW5QYWdlfT9zYW50YT0ke2VuY29kZVVSSUNvbXBvbmVudChwYWlyWzBdKX0mZGF0YT0ke2VuY29kZVVSSUNvbXBvbmVudChCYXNlNjQuZW5jb2RlKEpTT04uc3RyaW5naWZ5KGRhdGEpKSl9YCBcblxuICAgICAgICBjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgICAgIHNwYW4ub25jbGljayA9ICgpPT57XG4gICAgICAgICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChsaW5rKTtcbiAgICAgICAgfVxuICAgICAgICBzcGFuLmlubmVySFRNTCA9IGxpbmtcblxuICAgICAgICByZXR1cm4gW3BhaXJbMF0sIHNwYW4sIHBhaXJbMV1dXG4gICAgfSlcblxuXG4gICAgY29uc3QgaWQgPSBcIm91dHB1dFwiXG4gICAgdGFibGVHZW5lcmF0ZSh0YWJsZSwgW1wiU2FudGFcIiwgXCJTYW50YSdzIExpbmsgKGNsaWNrIHRvIGNvcHkpXCIsIFwiUmVjaXBpZW50XCJdLCBwYWlyTGluaywgaWQpXG5cbiAgICAvL3NldHVwIHNob3cgcmVjaXByaWVudHNcbiAgICBpZihzaG93UmVjaXByaWVudHNGdW5jdCkge1xuICAgICAgICBzaG93UmVjaXBpZW50cy5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIHNob3dSZWNpcHJpZW50c0Z1bmN0KVxuICAgIH1cbiAgICBcblxuICAgIHNob3dSZWNpcHJpZW50c0Z1bmN0ID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBlbG1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgLiR7aWR9LWl0ZW0tMmApXG4gICAgICAgIGVsbXMuZm9yRWFjaChlbG09PntcblxuICAgICAgICAgICAgZWxtLnN0eWxlLmRpc3BsYXkgPSAoc2hvd1JlY2lwaWVudHMuY2hlY2tlZCk/bnVsbDpcIm5vbmVcIlxuICAgICAgICB9KVxuICAgIH1cbiAgICBzaG93UmVjaXByaWVudHNGdW5jdCgpXG4gICAgc2hvd1JlY2lwaWVudHMuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBzaG93UmVjaXByaWVudHNGdW5jdClcbiAgICAvL3ByaW50KHNlcClcbn1cblxuXG5cbmxldCBzaHVmZmxlID0gKGFycmF5KSA9PiB7XG4gICAgcmV0dXJuIGFycmF5XG4gICAgICAgIC5tYXAoKHZhbHVlKSA9PiAoeyB2YWx1ZSwgc29ydDogTWF0aC5yYW5kb20oKSB9KSlcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IGEuc29ydCAtIGIuc29ydClcbiAgICAgICAgLm1hcCgoeyB2YWx1ZSB9KSA9PiB2YWx1ZSlcbn1cblxubGV0IGdlbmVyYXRlUGFpcnMgPSAocGVvcGxlKSA9PiB7XG4gICAgbGV0IHNodWZmbGVkID0gc2h1ZmZsZShwZW9wbGUpXG4gICAgbGV0IHBhaXJzID0gc2h1ZmZsZWQubWFwKCh2YWx1ZSwgaW5kZXgpID0+IHtcbiAgICAgICAgaWYoIXNodWZmbGVkW2luZGV4KzFdKSB7IC8vZW5kIGVkZ2UgY2FzZVxuICAgICAgICAgICAgcmV0dXJuIFt2YWx1ZSwgc2h1ZmZsZWRbMF1dXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFt2YWx1ZSwgc2h1ZmZsZWRbaW5kZXgrMV1dXG4gICAgfSlcblxuICAgIHJldHVybiBwYWlyc1xuXG59XG5cblxuXG5nZW5lcmF0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIFxuICAgIGdlbmVyYXRlKClcbn0pIl0sIm5hbWVzIjpbIl9oYXNidG9hIiwiYnRvYSIsIl9oYXNCdWZmZXIiLCJCdWZmZXIiLCJfVEUiLCJUZXh0RGVjb2RlciIsIlRleHRFbmNvZGVyIiwidW5kZWZpbmVkIiwiYjY0Y2hzIiwiQXJyYXkiLCJwcm90b3R5cGUiLCJzbGljZSIsImNhbGwiLCJfZnJvbUNDIiwiYSIsInRhYiIsImZvckVhY2giLCJjIiwiaSIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsImJpbmQiLCJfbWtVcmlTYWZlIiwiVWludDhBcnJheSIsImZyb20iLCJzcmMiLCJyZXBsYWNlIiwibTAiLCJfYnRvYSIsImJpbiIsInRvU3RyaW5nIiwidTMyIiwiYzAiLCJjMSIsImMyIiwiYXNjIiwicGFkIiwibGVuZ3RoIiwiY2hhckNvZGVBdCIsIlR5cGVFcnJvciIsInN1YnN0cmluZyIsIl9mcm9tVWludDhBcnJheSIsInU4YSIsInN0cnMiLCJsIiwicHVzaCIsImFwcGx5Iiwic3ViYXJyYXkiLCJqb2luIiwiY2JfdXRvYiIsImNjIiwicmVfdXRvYiIsIl9lbmNvZGUiLCJzIiwiZW5jb2RlIiwiZ0Jhc2U2NCIsInVybHNhZmUiLCJjb25zb2xlIiwibG9nIiwibmFtZUxpc3QiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZ2VuZXJhdGVCdXR0b24iLCJ0YWJsZSIsInNwZWNpYWxSdWxlcyIsInNob3dSZWNpcGllbnRzIiwibWFpblBhZ2UiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJzaG93UmVjaXByaWVudHNGdW5jdCIsImVycm9yIiwiYXJncyIsImVsbSIsImNyZWF0ZUVsZW1lbnQiLCJzdHlsZSIsImNvbG9yIiwiaW5uZXJUZXh0IiwicHJlcGVuZCIsImdlbmVyYXRlIiwic2VwIiwicXVlcnlTZWxlY3RvciIsInZhbHVlIiwibmFtZXMiLCJzcGxpdCIsIm1hcCIsIm5hbWUiLCJ0cmltIiwicGFpcnMiLCJnZW5lcmF0ZVBhaXJzIiwic2h1ZmZsZSIsInBhaXJMaW5rIiwicGFpciIsImRhdGEiLCJyZWNpcGllbnQiLCJsaW5rIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiSlNPTiIsInN0cmluZ2lmeSIsInNwYW4iLCJvbmNsaWNrIiwibmF2aWdhdG9yIiwiY2xpcGJvYXJkIiwid3JpdGVUZXh0IiwiaW5uZXJIVE1MIiwiaWQiLCJoZWFkZXJzIiwiY3J5cHRvIiwiZ2V0UmFuZG9tVmFsdWVzIiwidXVpZHY0IiwidHIiLCJlbGVtZW50IiwiaW5kZXgiLCJ0aCIsImFwcGVuZENoaWxkIiwicm93IiwiaXRlbSIsInRkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGFibGVHZW5lcmF0ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZGlzcGxheSIsImFkZEV2ZW50TGlzdGVuZXIiLCJhcnJheSIsInNvcnQiLCJNYXRoIiwicmFuZG9tIiwiYiIsInBlb3BsZSIsInNodWZmbGVkIl0sInNvdXJjZVJvb3QiOiIifQ==